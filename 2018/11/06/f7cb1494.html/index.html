<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="GicLYNNqJJ-XBSPlE8Pz-ZwGf2ElS_d_VRcEsQServ4"><meta name="google-site-verification" content="rn4dOdASKHwgOgBKFwN8nAB0OlnuC_pNB8qLDnMyPpc"><meta name="baidu-site-verification" content="093lY4ziMu"><meta name="baidu-site-verification" content="code-W4A0ktcwoi"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="description" content="nojsja 个人博客"><meta name="keyword" content=""><link rel="shortcut icon" href="/img/favicon.ico"><link href="/fonts/fontawesome-webfont.woff2?v=4.3.0" rel="preload" as="font" crossorigin><link href="https://www.google-analytics.com" rel="preconnect" crossorigin><link href="http://busuanzi.ibruce.info" rel="preconnect" crossorigin><link href="http://nojsja.gitee.io" rel="preconnect" crossorigin><title>用Javascript实现一个可自定义样式的tootips组件 - nojsja | Blog</title><link rel="canonical" href="https://nojsja.github.io/blogs/2018/11/06/f7cb1494.html/"><link href="https://cdn.usebootstrap.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/dusign-light.css"><link rel="stylesheet" href="/css/github-markdown.min.css"><style>.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}@media (max-width:767px){.markdown-body{padding:15px}}</style><link rel="stylesheet" href="/css/widget.css"><link rel="stylesheet" href="/css/fonts.googleapis.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><script>function async(e,t,a,n){var c=document.head||document.getElementsByTagName("head")[0]||document.documentElement,d=document,r=a||"script",s=d.createElement(r),l=d.getElementsByTagName(r)[0];switch(n=["async","defer"].includes(n)?n:!!n,r){case"script":s.src=e,n&&(s[n]=!0);break;case"link":s.type="text/css",s.href=e,s.rel="stylesheet";break;default:s.src=e}t&&(s.readyState?s.onreadystatechange=function(e){"loaded"!=s.readyState&&"complete"!=s.readyState||(s.onreadystatechange=null,t(null,e)())}:s.onload=function(e){t(null,e)}),l.parentNode.insertBefore(s,c.firstChild)}</script><script>function sendXMLHttpRequest(e){var t=e.url,n=(e.method||"get").toUpperCase(),s=e.callback,a=!("async"in e)||!!e.async,c=null;t&&((c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open(n,t,a),c.onreadystatechange=function(){4===this.readyState&&(s&&s(this.responseText),c.onreadystatechange=null)},c.send(null))}</script><script>var fnDebounce=function(n,l){var t=null;return function(){return t?Date.now()-t>=l?(t=null,n.apply(this,[].slice.call(arguments))):void(t=Date.now()):t=Date.now()}},fnThrottle=function(n,l){var t=null;return function(){return t?Date.now()-t>=l?(t=null,n.apply(this,[].slice.call(arguments))):void 0:t=Date.now()}}</script><script>"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}):sendXMLHttpRequest({url:"/js/intersection-observer.js",async:!1,method:"get",callback:function(txt){eval(txt)}})</script><script src="/js/buttons.js" async defer></script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="nojsja" type="application/atom+xml">
</head><body><style type="text/css">header.intro-header{background-image:linear-gradient(rgba(0,0,0,.3),rgba(0,0,0,.3)),url(https://nojsja.gitee.io/static-resources/images/hexo/article_header/article_header.jpg)}</style><header class="intro-header"><div id="signature"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><div class="tags"><a class="tag" href="/tags/#javascript" title="javascript">javascript</a></div><h1>用Javascript实现一个可自定义样式的tootips组件</h1><h2 class="subheading">animation javascript</h2><span class="meta"><span class="post-description"><i class="fa fa-user" aria-hidden="true"></i> nojsja </span><span class="post-description"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-06</span></span><div class="blank_box"></div><span class="meta">字数：<span class="post-count">2.7k</span>丨 阅读时间：<span class="post-count">13</span> 分钟</span><div class="blank_box"></div></div></div></div></div></div><div class="waveWrapper"><div class="wave wave_before" style="background-image:url(/img/wave-light.png)"></div><div class="wave wave_after" style="background-image:url(/img/wave-light.png)"></div></div></header><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class="container-fluid"><div class="navbar-header page-scroll"><button type="button" class="navbar-toggle"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="/">nojsja</a></div><div id="huxblog_navbar"><div class="navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">首页</a></li><li><a href="/about/">关于</a></li><li><a href="/archive/">时间轴</a></li><li><a href="/categories/">目录</a></li><li><a href="/tags/">标签</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");function handleMagic(e){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout((function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")}),400)):($collapse.style.height="auto",$navbar.className+=" in")}$toggle.addEventListener("click",handleMagic)</script><style>.table-responsive{border:none!important}</style><article><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container markdown-body"><h4 id="前言">前言</h4><blockquote><p>最近做的一个jQuery老项目经常会用tootips组件在一个html元素周围显示提示信息，虽然有现成的组件可以使用，但是很多tootips组件处理起来并不灵活，不能够自定义tootips样式和显示的内容及布局等等，而且tootips组件本身的样式可能会被目标组件的样式影响，所以想自己实现一个tootips组件：可以自定义显示内容，并且tootips的位置和布局完全不受页面元素影响。</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" lazyload data-loading="/img/loading.gif" data-src="tootip.png" alt="tootip.png"></p><h4 id="预览图">预览图</h4><hr><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/nojsja/javascript-learning/tree/master/code-challenge/es5-component/js-tooltips">=&gt; 源代码</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" lazyload data-loading="/img/loading.gif" data-src="tootips.gif" alt="animation.gif"></p><h4 id="代码实现">代码实现</h4><hr><h5 id="组件结构">组件结构</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> <span class="title class_">Tootips</span> = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 工具函数 */</span></span><br><span class="line">  <span class="keyword">var</span> utils = &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * [renderContainer 构造html]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[Object]</span>&#125; options   [自定义参数]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; type   [渲染类型 -&gt; text | html]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; target   [渲染字符串]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">renderContainer</span>(<span class="params">$selector, tootipKey</span>) &#123;</span><br><span class="line">   ...</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [showTootips 操作页面属性显示一个元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; tootipKey [可能已经生成过一次tooptips组件了]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">showTootips</span>(<span class="params">$selector</span>) &#123;</span><br><span class="line">   ...</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [hideTooTips 操作页面属性隐藏一个元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">hideTooTips</span>(<span class="params">$selector</span>) &#123;</span><br><span class="line">   ...</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [eventListen 进行事件监听]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; trigger [触发事件监听类型]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">eventListen</span>(<span class="params">$selector, _trigger, $context</span>) &#123;</span><br><span class="line">   ...</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [renderHtml 使用html字符串进行初始化]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; htmlstr   [html字符串]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[Object]</span>&#125; options   [自定义参数]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">init</span>(<span class="params">_$selector, _options</span>) &#123;</span><br><span class="line">   ...</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">   <span class="attr">init</span>: init,</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * [trigger 手动触发元素的显示和隐藏]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   <span class="attr">trigger</span>: <span class="keyword">function</span>(<span class="params">$selector</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;isActivated&#x27;</span>)) &#123;</span><br><span class="line">      <span class="title function_">showTootips</span>($selector, utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">hideTooTips</span>($selector);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [getStatus 获取某个元素的状态]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">   <span class="attr">status</span>: <span class="keyword">function</span> (<span class="params">$selector</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">isActivated</span>: utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;isActivated&#x27;</span>) ? <span class="literal">true</span> : <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">isInited</span>: utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>) ? <span class="literal">true</span> : <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">key</span>: utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>) || <span class="literal">null</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="工具函数封装">工具函数封装</h4><blockquote><p>主要用于简化dom操作，实现了一些类似jQuery的API；还封装了用于计算元素坐标的纯函数</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> utils = &#123;</span><br><span class="line">    <span class="attr">actions</span>: &#123;</span><br><span class="line">      <span class="comment">// [symbol]: [Timer]</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">element</span>: &#123;</span><br><span class="line">     <span class="attr">jsonWrapper</span>: <span class="keyword">function</span>(<span class="params">target</span>) &#123;</span><br><span class="line">       <span class="keyword">var</span> jsonParseRule = <span class="regexp">/^\&#123;&quot;([\w\W])+\&#125;$/</span>;</span><br><span class="line">       <span class="keyword">if</span> (jsonParseRule.<span class="title function_">test</span>(target)) <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(target);</span><br><span class="line">       <span class="keyword">return</span> (<span class="keyword">typeof</span> target === <span class="string">&#x27;object&#x27;</span> &amp;&amp; target !== <span class="literal">null</span>) ?</span><br><span class="line">         <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(target) :</span><br><span class="line">         target;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">elementWrapper</span>: <span class="keyword">function</span>(<span class="params">$element</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> (<span class="keyword">typeof</span> $element === <span class="string">&#x27;object&#x27;</span>) ? $element : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>($element);</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">setAttr</span>: <span class="keyword">function</span>(<span class="params">$element, key, value</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       (key) &amp;&amp; $element.<span class="title function_">setAttribute</span>(key, <span class="variable language_">this</span>.<span class="title function_">jsonWrapper</span>(value));</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">setCss</span>: <span class="keyword">function</span>(<span class="params">$element, styleKey, styleValue, important</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       $element.<span class="property">style</span>.<span class="title function_">setProperty</span>(styleKey, styleValue, important === <span class="string">&#x27;important&#x27;</span> ? important : <span class="literal">undefined</span>);</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">getAttr</span>: <span class="keyword">function</span>(<span class="params">$element, key</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       <span class="keyword">return</span> (key) ? <span class="variable language_">this</span>.<span class="title function_">jsonWrapper</span>($element.<span class="title function_">getAttribute</span>(key)) : <span class="literal">undefined</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">setData</span>: <span class="keyword">function</span>(<span class="params">$element, key, value</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       (key) &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">setAttr</span>($element, <span class="string">&#x27;data-&#x27;</span> + key, value);</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">getData</span>: <span class="keyword">function</span>(<span class="params">$element, key</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       <span class="keyword">return</span> key ? <span class="variable language_">this</span>.<span class="title function_">getAttr</span>($element, <span class="string">&#x27;data-&#x27;</span> + key) : <span class="literal">undefined</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">addClass</span>: <span class="keyword">function</span>(<span class="params">$element, className</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       <span class="keyword">var</span> classes = $element.<span class="property">className</span>.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">       <span class="keyword">if</span> (!classes.<span class="title function_">includes</span>(className)) &#123;</span><br><span class="line">         classes.<span class="title function_">push</span>(className);</span><br><span class="line">         $element.<span class="property">className</span> = classes.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">removeClass</span>: <span class="keyword">function</span>(<span class="params">$element, className</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       <span class="keyword">var</span> classes = $element.<span class="property">className</span>.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">       <span class="keyword">var</span> index = classes.<span class="title function_">indexOf</span>(className);</span><br><span class="line">       <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">         classes.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">         $element.<span class="property">className</span> = classes.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">empty</span>: <span class="keyword">function</span>(<span class="params">$element</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       $element.<span class="property">innerHTML</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">html</span>: <span class="keyword">function</span>(<span class="params">$element, htmlStr</span>) &#123;</span><br><span class="line">       $element = <span class="variable language_">this</span>.<span class="title function_">elementWrapper</span>($element);</span><br><span class="line">       $element.<span class="property">innerHTML</span> = htmlStr;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">   <span class="comment">/* 根据宿主元素第一次计算横坐标和纵坐标 */</span></span><br><span class="line">   <span class="attr">renderX1</span>: <span class="keyword">function</span> (<span class="params">r, d</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;top&#x27;</span> || d === <span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> + r.<span class="property">width</span> / <span class="number">2</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> - <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> + r.<span class="property">width</span> + <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;bottomleft&#x27;</span> || d === <span class="string">&#x27;topleft&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;bottomright&#x27;</span> || d === <span class="string">&#x27;topright&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> + r.<span class="property">width</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">renderY1</span>: <span class="keyword">function</span> (<span class="params">r, d</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;top&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> - <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;left&#x27;</span> || d === <span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> + r.<span class="property">height</span> / <span class="number">2</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> + r.<span class="property">height</span> + <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;bottomleft&#x27;</span> || d === <span class="string">&#x27;bottomright&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> + r.<span class="property">height</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;topleft&#x27;</span> || d === <span class="string">&#x27;topright&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">/* 根据生成的tootips元素宽高第二次计算横坐标和纵坐标 */</span></span><br><span class="line">   <span class="attr">renderX2</span>: <span class="keyword">function</span> (<span class="params">r, d</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;top&#x27;</span> || d === <span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> - r.<span class="property">width</span> / <span class="number">2</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;left&#x27;</span> || d === <span class="string">&#x27;bottomleft&#x27;</span> || d === <span class="string">&#x27;topleft&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> - r.<span class="property">width</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">x</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;bottomright&#x27;</span> || d === <span class="string">&#x27;topright&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> (r.<span class="property">x</span> + r.<span class="property">widht</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">renderY2</span>: <span class="keyword">function</span> (<span class="params">r, d</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;top&#x27;</span> || d === <span class="string">&#x27;topleft&#x27;</span> || d === <span class="string">&#x27;topright&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> - r.<span class="property">height</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;left&#x27;</span> || d === <span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> - r.<span class="property">height</span> / <span class="number">2</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">     <span class="keyword">if</span> (d === <span class="string">&#x27;bottom&#x27;</span> || d === <span class="string">&#x27;bottomleft&#x27;</span> || d === <span class="string">&#x27;bottomright&#x27;</span>)</span><br><span class="line">       <span class="keyword">return</span> (r.<span class="property">y</span> + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">/* 使用函数去抖防止调用混乱 */</span></span><br><span class="line">   <span class="attr">actionDebounce</span>: <span class="keyword">function</span>(<span class="params">symbol, action, params</span>) &#123;</span><br><span class="line">     <span class="keyword">var</span> that = <span class="variable language_">this</span>;</span><br><span class="line">     <span class="keyword">var</span> timer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">       <span class="title function_">action</span>(params);</span><br><span class="line">       <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">       <span class="keyword">delete</span> that.<span class="property">actions</span>[symbol];</span><br><span class="line">     &#125;, <span class="number">300</span>);</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">if</span> (!that.<span class="property">actions</span>[symbol]) &#123;</span><br><span class="line">       that.<span class="property">actions</span>[symbol] = timer;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="built_in">clearTimeout</span>(that.<span class="property">actions</span>[symbol]);</span><br><span class="line">       that.<span class="property">actions</span>[symbol] = timer;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h5 id="初始化一个元素">初始化一个元素</h5><blockquote><p>对一个html元素进行初始化，在元素上绑定数据和设置事件监听器</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * [renderHtml 使用html字符串进行初始化]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; htmlstr   [html字符串]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">[Object]</span>&#125; options   [自定义参数]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">init</span>(<span class="params">_$selector, _options</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> $selector = utils.<span class="property">element</span>.<span class="title function_">elementWrapper</span>(_$selector),</span><br><span class="line">      trigger = _options[<span class="string">&#x27;trigger&#x27;</span>] ? _options[<span class="string">&#x27;trigger&#x27;</span>] : <span class="string">&#x27;mouseover&#x27;</span>, <span class="comment">// click | hover</span></span><br><span class="line">      $context = utils.<span class="property">element</span>.<span class="title function_">elementWrapper</span>(_options[<span class="string">&#x27;context&#x27;</span>]),</span><br><span class="line">      key = utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">   utils.<span class="property">element</span>.<span class="title function_">setData</span>($selector, <span class="string">&#x27;tootip-target&#x27;</span>, _options.<span class="property">value</span>)</span><br><span class="line">     .<span class="title function_">setData</span>($selector, <span class="string">&#x27;tootip-type&#x27;</span>, _options.<span class="property">type</span>)</span><br><span class="line">     .<span class="title function_">setData</span>($selector, <span class="string">&#x27;tootip-options&#x27;</span>, _options)</span><br><span class="line">     .<span class="title function_">setData</span>($selector, <span class="string">&#x27;tootip-trigger&#x27;</span>, _options.<span class="property">trigger</span>)</span><br><span class="line">     .<span class="title function_">setCss</span>($selector, <span class="string">&#x27;cursor&#x27;</span>, <span class="string">&#x27;pointer&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  (!key) &amp;&amp; <span class="title function_">eventListen</span>($selector, trigger, $context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="根据传入属性创建tootips组件">根据传入属性创建tootips组件</h5><ul><li>使用<code>getBoundingClientRect()</code>方法获取目标组件的位置和宽高</li><li>tootips组件根据获取的位置和宽高进行窗口定位(<code>position: fixed</code>)</li><li>根据传入的属性设置tootips组件的样式</li><li>返回一个dom元素</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * [renderContainer 构造html]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[Object]</span>&#125; options   [自定义参数]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; type   [渲染类型 -&gt; text | html]</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; target   [渲染字符串]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">renderContainer</span>(<span class="params">$selector, tootipKey</span>) &#123;</span><br><span class="line">   <span class="keyword">var</span> type = utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;tootip-type&#x27;</span>),</span><br><span class="line">      options = utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;tootip-options&#x27;</span>),</span><br><span class="line">      trigger = utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;tootip-trigger&#x27;</span>),</span><br><span class="line">      target = utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;tootip-target&#x27;</span>);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 提取属性</span></span><br><span class="line">   <span class="keyword">var</span> randomKey = <span class="string">&#x27;_&#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>(<span class="number">36</span>).<span class="title function_">substr</span>(<span class="number">2</span>);</span><br><span class="line">   <span class="keyword">var</span> $wrapper = tootipKey ? utils.<span class="property">element</span>.<span class="title function_">elementWrapper</span>(<span class="string">&#x27;div[tootip-key=&#x27;</span>+tootipKey+<span class="string">&#x27;]&#x27;</span>) : <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">   <span class="keyword">var</span> cssStyle = options.<span class="property">style</span> || &#123;&#125;;</span><br><span class="line">   <span class="keyword">var</span> styleSheet = options.<span class="property">css</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">   <span class="keyword">var</span> direction = options.<span class="property">direction</span> || <span class="string">&#x27;top&#x27;</span>;</span><br><span class="line">   <span class="keyword">var</span> triangleArray = [<span class="string">&#x27;top&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;bottom&#x27;</span>];</span><br><span class="line">   <span class="keyword">var</span> triangleClass = <span class="string">&#x27;triangle-&#x27;</span> +</span><br><span class="line">     triangleArray[triangleArray.<span class="property">length</span> - <span class="number">1</span> - triangleArray.<span class="title function_">indexOf</span>(direction)];</span><br><span class="line">   <span class="keyword">var</span> shadowClassMap = &#123;</span><br><span class="line">     <span class="attr">top</span>: <span class="string">&#x27;tootip-shadow-top-right&#x27;</span>,</span><br><span class="line">     <span class="attr">bottom</span>: <span class="string">&#x27;tootip-shadow-bottom-right&#x27;</span>,</span><br><span class="line">     <span class="attr">left</span>: <span class="string">&#x27;tootip-shadow-top-left&#x27;</span>,</span><br><span class="line">     <span class="attr">right</span>: <span class="string">&#x27;tootip-shadow-top-right&#x27;</span>,</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">var</span> rect = $selector.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line"></span><br><span class="line">   utils.<span class="property">element</span>.<span class="title function_">setCss</span>($wrapper, <span class="string">&#x27;border&#x27;</span>, <span class="string">&#x27;solid 1px rgb(212, 212, 212)&#x27;</span>)</span><br><span class="line">    .<span class="title function_">setCss</span>($wrapper, <span class="string">&#x27;position&#x27;</span>, <span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    .<span class="title function_">setCss</span>($wrapper, <span class="string">&#x27;left&#x27;</span>, utils.<span class="title function_">renderX1</span>(rect, direction))</span><br><span class="line">    .<span class="title function_">setCss</span>($wrapper, <span class="string">&#x27;top&#x27;</span>, utils.<span class="title function_">renderY1</span>(rect, direction))</span><br><span class="line">    .<span class="title function_">setAttr</span>($wrapper, <span class="string">&#x27;tootip-key&#x27;</span>, tootipKey || randomKey)</span><br><span class="line">    .<span class="title function_">addClass</span>($wrapper, triangleClass + <span class="string">&#x27; abnormal-tips-container &#x27;</span> + shadowClassMap[direction] + <span class="string">&#x27; &#x27;</span> + styleSheet);</span><br><span class="line">    utils.<span class="property">element</span>.<span class="title function_">setAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>, tootipKey || randomKey);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 第一次创建dom结构</span></span><br><span class="line">   <span class="keyword">if</span> (!tootipKey &amp;&amp; trigger === <span class="string">&#x27;mouseover&#x27;</span>) &#123;</span><br><span class="line">     $wrapper.<span class="property">onmouseout</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">       utils.<span class="title function_">actionDebounce</span>(randomKey, hideTooTips, $selector);</span><br><span class="line">     &#125;;</span><br><span class="line">     $wrapper.<span class="property">onmouseover</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">       utils.<span class="title function_">actionDebounce</span>(randomKey, showTootips, $selector);</span><br><span class="line">     &#125;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="title class_">Object</span>.<span class="title function_">keys</span>(cssStyle).<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">attr</span>) &#123;</span><br><span class="line">     utils.<span class="property">element</span>.<span class="title function_">setCss</span>($wrapper, attr, cssStyle[attr]);</span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line">   utils.<span class="property">element</span>.<span class="title function_">html</span>($wrapper, type === <span class="string">&#x27;html&#x27;</span> ? target : (<span class="string">&#x27;&lt;span&gt;&#x27;</span> + target +<span class="string">&#x27;&lt;/span&gt;&#x27;</span>));</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> $wrapper;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><h5 id="绑定事件监听器">绑定事件监听器</h5><blockquote><p>对一个元素进行初始化后需要给tooltips组件绑定监听器(<code>click</code>或<code>mouse</code>事件)，让tootips组件能够响应鼠标的点击或是划过</p></blockquote><p>注意<code>utils.actionDebounce</code>方法运用了函数去抖的思想，防止在短时间内高频触发Tootip显示/隐藏时发生的调用混乱问题，多次调用时只响应最新的触发事件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [eventListen 进行事件监听]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; trigger [触发事件监听类型]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">eventListen</span>(<span class="params">$selector, _trigger, $context</span>) &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> trigger = (_trigger <span class="keyword">instanceof</span> <span class="title class_">Array</span>) ? _trigger : [_trigger];</span><br><span class="line"></span><br><span class="line">   <span class="comment">// click事件监听</span></span><br><span class="line">   <span class="keyword">if</span>(trigger.<span class="title function_">includes</span>(<span class="string">&#x27;click&#x27;</span>)) &#123;</span><br><span class="line">     ($context || $selector)</span><br><span class="line">       .<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         <span class="keyword">if</span> (!utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;isActivated&#x27;</span>)) &#123;</span><br><span class="line">           utils.<span class="title function_">actionDebounce</span>(utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>), showTootips, $selector);</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           utils.<span class="title function_">actionDebounce</span>(utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>), hideTooTips, $selector);</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;;</span><br><span class="line">   &#125; </span><br><span class="line"></span><br><span class="line">   <span class="comment">// 鼠标事件监听</span></span><br><span class="line">   <span class="keyword">if</span>(trigger.<span class="title function_">includes</span>(<span class="string">&#x27;mouseover&#x27;</span>)) &#123;</span><br><span class="line">     ($context || $selector)</span><br><span class="line">       .<span class="property">onmouseout</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         utils.<span class="title function_">actionDebounce</span>(utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>), hideTooTips, $selector);</span><br><span class="line">       &#125;;</span><br><span class="line">     ($context || $selector)</span><br><span class="line">       .<span class="property">onmouseover</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         utils.<span class="title function_">actionDebounce</span>(utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>), showTootips, $selector);</span><br><span class="line">       &#125;;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>实现showTootips方法<br>在tootips组件中可以自定义显示html内容或text内容，tootips组件被添加到页面之前，tootips组件的宽度和高度是不可获取的，所以在show方法中需要对tootips元素进行二次定位，同样使用<code>getBoundingClientRect()</code>方法获取tootips元素坐标和宽高。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [showTootips 操作页面属性显示一个元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[String]</span>&#125; tootipKey [可能已经生成过一次tooptips组件了]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">showTootips</span>(<span class="params">$selector</span>) &#123;</span><br><span class="line">   <span class="keyword">if</span> (utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;isActivated&#x27;</span>)) <span class="keyword">return</span>;</span><br><span class="line">   <span class="keyword">var</span> tootipKey = utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>);</span><br><span class="line">   <span class="keyword">var</span> $dom = <span class="title function_">renderContainer</span>($selector, tootipKey);</span><br><span class="line">   <span class="keyword">if</span> (!tootipKey) &#123;</span><br><span class="line">     <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>($dom);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    utils.<span class="property">element</span>.<span class="title function_">removeClass</span>($dom, <span class="string">&#x27;hidden&#x27;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   utils.<span class="property">element</span>.<span class="title function_">setData</span>($selector, <span class="string">&#x27;isActivated&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> options = utils.<span class="property">element</span>.<span class="title function_">getData</span>($selector, <span class="string">&#x27;tootip-options&#x27;</span>);</span><br><span class="line">   <span class="keyword">var</span> rect = $dom.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line"></span><br><span class="line">   utils.<span class="property">element</span></span><br><span class="line">     .<span class="title function_">setCss</span>($dom, <span class="string">&#x27;top&#x27;</span>, utils.<span class="title function_">renderY2</span>(rect, options.<span class="property">direction</span>))</span><br><span class="line">     .<span class="title function_">setCss</span>($dom, <span class="string">&#x27;left&#x27;</span>, utils.<span class="title function_">renderX2</span>(rect, options.<span class="property">direction</span>));</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><ul><li>实现hideTootips方法<br>hide方法的作用是将当前元素对应的tootips组件从页面移出，之前初始化的时候在目标元素和生成的tootips元素上设置了同一个<code>key</code>属性，现在可以根据<code>key</code>来移除每个目标元素对应的tootips元素。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * [hideTooTips 操作页面属性隐藏一个元素]</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  &#123;<span class="type">[$Object]</span>&#125; $selector [一个页面元素]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">hideTooTips</span>(<span class="params">$selector</span>) &#123;</span><br><span class="line">   <span class="keyword">var</span> key = utils.<span class="property">element</span>.<span class="title function_">getAttr</span>($selector, <span class="string">&#x27;tootip-key&#x27;</span>);</span><br><span class="line">   <span class="keyword">var</span> $element = utils.<span class="property">element</span>.<span class="title function_">elementWrapper</span>(<span class="string">&#x27;div[tootip-key=&#x27;</span>+key+<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">   utils.<span class="property">element</span>.<span class="title function_">addClass</span>($element, <span class="string">&#x27;hidden&#x27;</span>);</span><br><span class="line">   utils.<span class="property">element</span>.<span class="title function_">setData</span>($selector, <span class="string">&#x27;isActivated&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><h5 id="使用方式">使用方式</h5><blockquote><p>设置tootips方向、显示内容字符串(可以是html字符串)、触发方式(click / mouseover)、自定义css属性、自定义样式表。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Tootips</span>.<span class="title function_">init</span>((<span class="string">&#x27;#t1&#x27;</span>), &#123;</span><br><span class="line">  <span class="attr">trigger</span>: <span class="string">&#x27;mouseover&#x27;</span>, <span class="comment">// 触发方式</span></span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;html&#x27;</span>, <span class="comment">// 内容显示类型</span></span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;&lt;h3&gt;header&lt;/h3&gt;&lt;p&gt;body&lt;/p&gt;&#x27;</span>, <span class="comment">// 内容显示值</span></span><br><span class="line">  <span class="attr">direction</span>: <span class="string">&#x27;top&#x27;</span>, <span class="comment">// 显示方向</span></span><br><span class="line">  <span class="attr">style</span>: &#123; <span class="comment">// tootips组件自定义样式</span></span><br><span class="line">    <span class="string">&#x27;font-size&#x27;</span>: <span class="string">&#x27;1rem&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;min-width&#x27;</span>: <span class="string">&#x27;5rem&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;padding&#x27;</span>: <span class="string">&#x27;5px 10px&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;5px&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;background-color&#x27;</span>: <span class="string">&#x27;white&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">css</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// tootips组件自定义样式表</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="总结">总结</h4><hr><ul><li>tootips组件的坐标完全使用javasript来获取和设置</li><li>tootips组件的定位类型为<code>position: fixed</code>，不受页面布局影响</li><li><code>getBoundingClientRect()</code>方法可以获取目标元素的坐标、宽高等数据</li><li>tootips组件支持传入自定义样式</li><li>tootips组件支持显示含有html标签的字符串和普通字符串</li><li>tootips组件支持设置触发方式(<code>click</code> / <code>mouseover</code>)</li></ul><h5 id="感谢阅读">感谢阅读</h5><span class="meta" id="headerViewCountWrapper"><span id="<Your/Path/Name>" class="leancloud_visitors" data-flag-title="Your Article Title"><em class="post-meta-item-text">⇸⇸ 阅读量：</em> <i class="leancloud-visitors-count">[ loading ]</i>⇷⇷</span></span><script>document.querySelector("#headerViewCountWrapper > .leancloud_visitors").id=decodeURIComponent(window.location.pathname)</script><hr style="margin-top:5px"><ul class="pager"><li class="previous"><a href="/2019/04/04/d04b08a2.html/" data-toggle="tooltip" data-placement="top" title="proxychains终端代理">&larr; Previous Post</a></li><li class="next"><a href="/2018/11/05/3fd62b7c.html/" data-toggle="tooltip" data-placement="top" title="简单实现一个Javascript动画处理类">Next Post &rarr;</a></li></ul><style type="text/css">.aplayer-container{text-align:center}.lds-roller-loading{display:inline-block;position:relative;width:80px;height:80px}.lds-roller-loading div{animation:lds-roller 1.2s cubic-bezier(.5,0,.5,1) infinite;transform-origin:40px 40px}.lds-roller-loading div:after{content:" ";display:block;position:absolute;width:7px;height:7px;border-radius:50%;background:#ff59ac;margin:-4px 0 0 -4px}.lds-roller-loading div:nth-child(1){animation-delay:-36ms}.lds-roller-loading div:nth-child(1):after{top:63px;left:63px}.lds-roller-loading div:nth-child(2){animation-delay:-72ms}.lds-roller-loading div:nth-child(2):after{top:68px;left:56px}.lds-roller-loading div:nth-child(3){animation-delay:-108ms}.lds-roller-loading div:nth-child(3):after{top:71px;left:48px}.lds-roller-loading div:nth-child(4){animation-delay:-144ms}.lds-roller-loading div:nth-child(4):after{top:72px;left:40px}.lds-roller-loading div:nth-child(5){animation-delay:-.18s}.lds-roller-loading div:nth-child(5):after{top:71px;left:32px}.lds-roller-loading div:nth-child(6){animation-delay:-216ms}.lds-roller-loading div:nth-child(6):after{top:68px;left:24px}.lds-roller-loading div:nth-child(7){animation-delay:-252ms}.lds-roller-loading div:nth-child(7):after{top:63px;left:17px}.lds-roller-loading div:nth-child(8){animation-delay:-288ms}.lds-roller-loading div:nth-child(8):after{top:56px;left:12px}@keyframes lds-roller{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.aplayer .aplayer-pic .aplayer-pause svg{top:0;left:0}.aplayer .aplayer-pic .aplayer-play svg{top:0;left:2px}</style><div class="aplayer-container"><div id="aplayer" class="lds-roller-loading" lazy-css-href="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.css" lazy-js-src="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.js"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div><script>(function(){var e,t=document.querySelector("#aplayer"),s=function(s,i){var r=[];s&&r.push(s),i&&r.push(i),r.forEach((function(s){async(s,(function(){/^.*.js$/.test(s)&&function(){e&&e.disconnect(),t.className="",t.innerHTML="";new APlayer({container:document.getElementById("aplayer"),theme:"#e9e9e9",audio:[{name:"存在信号",artist:"AcuticNotes",url:"http://nojsja.gitee.io/static-resources/audio/life-signal.mp3",cover:"http://nojsja.gitee.io/static-resources/audio/life-signal.jpg"},{name:"遺サレタ場所／斜光",artist:"岡部啓一",url:"http://nojsja.gitee.io/static-resources/audio/%E6%96%9C%E5%85%89.mp3",cover:"http://nojsja.gitee.io/static-resources/audio/%E6%96%9C%E5%85%89.jpg"}]})}()}),/^.*.css$/.test(s)?"link":"script")}))};if(window.IntersectionObserver)(e=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){e.unobserve(t.target);var i=t.target.getAttribute("lazy-css-href"),r=t.target.getAttribute("lazy-js-src");s(i,r)}}))}))).observe(t);else{var i=t.getAttribute("lazy-css-href"),r=t.getAttribute("lazy-js-src");s(i,r)}}).bind(window)()</script><hr><div id="vcomments"></div><script>(function(){function e(){async("/js/Valine.min.js",(function(){new Valine({el:"#vcomments",appId:"wUKKBx8BRzGaNfhgdg2UKtub-MdYXbMMI",appKey:"MAwYM4KlW5YJ3q06qwnUScBr",visitor:!0})}))}if(window.IntersectionObserver){var n=new IntersectionObserver((function(i){i.forEach((function(i){i.isIntersecting&&(n.unobserve(i.target),n.disconnect(),e())}))}));n.observe(document.querySelector("#headerViewCountWrapper"))}else e()}).bind(window)()</script></div><aside id="sidebar"><div id="toc" class="toc-article"><strong class="toc-title">Contents</strong><ol class="toc-nav"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">前言</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A2%84%E8%A7%88%E5%9B%BE"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">预览图</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">代码实现</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">组件结构</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">工具函数封装</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">初始化一个元素</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%A0%B9%E6%8D%AE%E4%BC%A0%E5%85%A5%E5%B1%9E%E6%80%A7%E5%88%9B%E5%BB%BAtootips%E7%BB%84%E4%BB%B6"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">根据传入属性创建tootips组件</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-nav-number">4.3.</span> <span class="toc-nav-text">绑定事件监听器</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-nav-number">4.4.</span> <span class="toc-nav-text">使用方式</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">总结</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%84%9F%E8%B0%A2%E9%98%85%E8%AF%BB"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">感谢阅读</span></a></li></ol></li></ol></div></aside></div></div></article><script>async("https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js",(function(){anchors.options={visible:"hover",placement:"left",icon:"ℬ"},anchors.add().remove(".intro-header h1").remove(".subheading").remove(".sidebar-container h5")}))</script><script src="https://lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><script type="text/javascript" src="/js/anchor.nojsja.js"></script><style>#websiteModal .modal-body{display:flex;align-items:center;justify-content:center;margin:auto;text-align:center;width:100%;height:100%}#websiteModal .modal-body img{max-width:100%;height:auto}</style><script>$(document).ready((function(){$(document).on("click","img",(function(o){if($(this).hasClass("click-disable"))o&&o.stopPropagation();else{o&&o.stopPropagation();var a=$(this).clone();$("#websiteModal").modal("show"),a.addClass("click-disable"),$("#websiteModal .modal-body").html(a)}})).on("click",".modal-body",(function(){$("#websiteModal").modal("hide")}))}))</script><div class="modal fade" id="websiteModal" tabindex="-1" role="dialog" aria-labelledby="websiteModalTitle" aria-hidden="true"><div class="modal-body"></div></div><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/nojsja"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; nojsja 2023</p></div></div></div></footer><script src="https://lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><script src="https://cdn.usebootstrap.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/js/widgets.js"></script><script>async("https://nojsja.gitee.io/static-resources/libs/fastclick/1.0.6/fastclick.min.js",(function(){var t=document.querySelector("nav");t&&FastClick.attach(t)}))</script><script type="text/javascript">var search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path;searchFunc(path,"local-search-input","local-search-result")</script><script src="/js/busuanzi.pure.mini.js" defer async></script><a id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js" async></script><script>(function(){function t(t){return document.querySelectorAll(t)}if(window.hexoLoadingImages=window.hexoLoadingImages||{},window.IntersectionObserver){var e=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){e.unobserve(t.target);var n=new Image,o="_img_"+Math.random();window.hexoLoadingImages[o]=n,n.onload=function(){t.target.src=t.target.getAttribute("data-src"),window.hexoLoadingImages[o]=null},n.onerror=function(){window.hexoLoadingImages[o]=null},t.target.src=t.target.getAttribute("data-loading"),n.src=t.target.getAttribute("data-src")}}))}));t("img[lazyload]").forEach((function(t){e.observe(t)}))}else t("img[lazyload]").forEach((function(t){t.src=t.getAttribute("data-src")}))}).bind(window)()</script></body></html>